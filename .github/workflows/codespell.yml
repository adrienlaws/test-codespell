name: Spelling Check

on: 
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]
  workflow_dispatch:
  
jobs:
  codespell:
    name: SpellCheck
    runs-on: ubuntu-latest

    steps:
      - name: Get changed files
        id: changed_files
        run: |
          git diff --name-only HEAD~1 HEAD > changed_files.txt
          cat changed_files.txt

      - name: Run Codespell on changed files
        if: success()  # Ensure previous step succeeded
        run: |
          if [ -s changed_files.txt ]; then
            xargs codespell < changed_files.txt || true
          else
            echo "No changed files to check."
        shell: bash
